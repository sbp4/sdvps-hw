# Домашнее задание к занятию "7.1. Ansible"

**

### Задание 1. 

Какие преимущества дает подход IAC?

*Приведите ответ в свободной форме.*

---

*** Ответ: ***

Преимуества IaC - согласованность, снижение расходов, скорость, эффективность и уменьшение рисков. Инфраструктура IaC может повысить согласованность и сократить число ошибок, которые часто имеют место при построении конфигураций вручную. Снижение расходов при использовании IaC относится не только к денежной, но и временной составляющей. Количество времени, затрачиваемое на рутинные операции уменьшается. Это в свою очередь увеличивает скорость развертывания инфраструктуры и позволяет эффективнее использовать существующие ресурсы. Благодаря кодированию инфраструктуры, появляется возможность создавать шаблоны для подготовки и выделения ресурсов, что упрощает конфигурацию, обслуживание систем и управление ими. Кроме того, автоматизация позволяет минимизировать риск возникновения человеческой ошибки, что важно при развертывании инфрастурктуры из большого количества серверов. 

---

### Задание 2 

1. Установите Ansible.
2. Настройте управляемые машины (виртуальные или физические, не менее двух).
3. Создайте файл инвентори. Предлагается использовать файл, размещенный в папке с проектом, а не файл инвентори по умолчанию.
4. Проверьте доступность хостов с помощью модуля ping.


*Приложите скриншоты действий.*

---

*** Ответ: ***

1. <a href="https://ibb.co/XsY23fq"><img src="https://i.ibb.co/WyVxPNL/1-1.png" alt="1-1" border="0"></a>

2. <a href="https://ibb.co/ydQhL8Z"><img src="https://i.ibb.co/wBzJDKP/1-2-1.png" alt="1-2-1" border="0"></a>

   <a href="https://ibb.co/P9yVrG7"><img src="https://i.ibb.co/NmqGF28/1-2-2.png" alt="1-2-2" border="0"></a>

3. <a href="https://ibb.co/dLtdm3n"><img src="https://i.ibb.co/fn9hDKm/1-3.png" alt="1-3" border="0"></a>

4. <a href="https://ibb.co/SQXr1Y7"><img src="https://i.ibb.co/q0M54qF/1-4-1.png" alt="1-4-1" border="0"></a>

   <a href="https://ibb.co/smqDrHx"><img src="https://i.ibb.co/GxR1jTY/1-4-2.png" alt="1-4-2" border="0"></a>

---

### Задание 3 

Какая разница между параметрами forks и serial? 


*Приведите ответ в свободной форме.*

---

*** Ответ: ***

Forks - определяет максимальное количество нод в одной партии, на которых будет параллельно выполняться одна задача из playbook'а. Чем больше узлов, на которых Ansible выполняет задачи параллельно, тем больше ресурсов CPU и памяти нужно на сервере, где крутится узел управления Ansible (control node).
Serial - ограничивает количество нод внутри одной партии для того, чтобы снизить потребление ресурсов CPU и памяти. Этот параметр удобно использовать, к примеру, когда нужно обновить несколько одинаковых серверов за балансировщиком – исключить одновременное отключение всех рабочих инстансов. Или для проверочных прогонов – к примеру разделить ноды одной партии на две части, и сначала проверить все задачи на одной части серверов этой партии, затем проверить оставшиеся.

---

### Задание 4 

В этом задании мы будем работать с Ad-hoc коммандами.

1. Установите на управляемых хостах пакет, которого нет(любой).
2. Проверьте статус любого присутствующего на управляемой машине сервиса. 
3. Создайте файл с содержимым "I like Linux" по пути /tmp/netology.txt

*Приложите скриншоты запуска команд.*
 
---

*** Ответ: ***

1. <a href="https://ibb.co/xgJJWmG"><img src="https://i.ibb.co/gWzzNvw/4-1-1.png" alt="4-1-1" border="0"></a>

   <a href="https://ibb.co/bFjrHb4"><img src="https://i.ibb.co/f9VC8D3/4-1-2.png" alt="4-1-2" border="0"></a>

2. <a href="https://ibb.co/p2FQ0TG"><img src="https://i.ibb.co/2q4Snrm/4-2.png" alt="4-2" border="0"></a>

3. <a href="https://ibb.co/h8L2yDC"><img src="https://i.ibb.co/s3bs2yt/4-3-1.png" alt="4-3-1" border="0"></a>

   <a href="https://ibb.co/GnYBwH9"><img src="https://i.ibb.co/ydvGT4p/4-3-2.png" alt="4-3-2" border="0"></a>

---

### Задание 5

Напишите 3 playbook'a. При написании рекомендуется использовать текстовый редактор с подсветкой синтаксиса YAML.
Плейбуки должны: 
1. Скачать какой либо архив, создать папку для распаковки и распаковать скаченный архив. Например, можете использовать официальный сайт и зеркало Apache Kafka https://kafka.apache.org/downloads. При этом можно качать как исходный код, так и бинарные файлы (запакованные в архив), в нашем задании не принципиально.
2. Установить пакет tuned из стандартного репозитория вашей ОС. Запустить его как демон (конфигурационный файл systemd появится автоматически при установке). Добавить tuned в автозагрузку.
3. Изменить приветствие системы (motd) при входе на любое другое по вашему желанию. Пожалуйста, в этом задании используйте переменную для задания приветствия. Переменную можно задавать любым удобным вам способом.

*Приложите файлы с плейбуками и вывод выполнения.*

---

*** Ответ: ***

'''
---
- name: play - 1
  hosts: webservers
  become: yes
  gather_facts: no
  tasks:

  - name: download nginx
    uri:
      url: https://nginx.org/download/nginx-1.23.1.tar.gz
      dest: /tmp

  - name: create directory
    file:
      path: "{{ item }}"
      state: directory
      owner: vagrant
      group: vagrant
      mode: 0777
    loop:
      - '/home/vagrant/nginx'

  - name: extract nginx.tar.gz into /home/vagrant/nginx
    ansible.builtin.unarchive:
      src: /tmp/nginx-1.23.1.tar.gz
      dest: /home/vagrant/nginx
      remote_src: yes

- name: play - 2
  hosts: webservers
  become: yes
  gather_facts: no
  tasks:

  - name: install tuned
    yum:
      name: tuned
      state: present

  - name: systemd reload
    systemd:
      daemon_reload: yes

  - name: tuned enable
    systemd:
      name: tuned
      enabled: yes

- name: play -3
  hosts: webservers
  become: yes
  gather_facts: no
  tasks:

  - name: change motd
    lineinfile:
      path: /etc/motd
      line: Welcome to {{ inventory_hostname }}.
      state: present

...
'''

1. 

<a href="https://ibb.co/8mXSGy5"><img src="https://i.ibb.co/10bwBCq/5-1-1.png" alt="5-1-1" border="0"></a>

<a href="https://ibb.co/rGPgZ8f"><img src="https://i.ibb.co/JRLNz6F/5-1-2.png" alt="5-1-2" border="0"></a>

<a href="https://ibb.co/hmnBhBR"><img src="https://i.ibb.co/BC7ydyV/5-1-3.png" alt="5-1-3" border="0"></a>

2. 

<a href="https://ibb.co/SdGqddn"><img src="https://i.ibb.co/7RL7RRW/5-2-1.png" alt="5-2-1" border="0"></a>

<a href="https://ibb.co/bJ648xM"><img src="https://i.ibb.co/M6gz3bx/5-2-2.png" alt="5-2-2" border="0"></a>

3.

<a href="https://ibb.co/TLcqZm2"><img src="https://i.ibb.co/Kw6zYFh/5-3-1.png" alt="5-3-1" border="0"></a>

<a href="https://ibb.co/0Qf15Nw"><img src="https://i.ibb.co/jHLqtKp/5-3-2.png" alt="5-3-2" border="0"></a>

---
 
**

## Дополнительные задания (со звездочкой*)
Эти задания дополнительные (не обязательные к выполнению) и никак не повлияют на получение вами зачета по этому домашнему заданию. Вы можете их выполнить, если хотите глубже и/или шире разобраться в материале.


### Задание 6

Задание модифицировать playbook из 3 пункта 5 задания: 

Playbook должен в качестве приветствия установить ip адрес и hostname усправляемого хоста, пожелание хорошего дня системному администратору. 

*Приложите файл с модифицированным плейбуком и вывод выполнения.*

---

*** Ответ: ***



---

### Задание 7

Создайте playbook, который будет включать в себя одну, вами созданную роль.
Роль должна:

1. Установить веб сервер Apache на управляемые хосты.
2. Сконфигурировать файл index.html c выводом характеристик для каждого компьютера. Необходимо включить CPU, RAM, величину первого HDD, ip адрес.
3. Открыть порт 80 (если необходимо), запустить сервер и добавить его в автозагрузку.
4. Сделать проверку доступности веб сайта(ответ 200).

*Приложите архив с ролью и вывод выполнения.*

---

*** Ответ: ***


---